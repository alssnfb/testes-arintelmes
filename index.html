

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>AR Intelmes</title>
    <link rel="icon" href="https://img.icons8.com/ios_filled/200/40C057/info.png">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="script.js" defer></script>
    
    <style>
        #a-scene {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
 
<body>
    <a-scene
        id="a-scene"
        embedded
        arjs="sourceType: webcam; sourceWidth:1280; sourceHeight:960; displayWidth: 1280; displayHeight: 960; detectionMode: mono_and_matrix; matrixCodeType: 3x3; "
        init-ar initGauges productionBar
    >
    <a-nft type="nft" url="https://cors-anywhere.herokuapp.com/https://raw.githubusercontent.com/alssnfb/nftmarkertest/main/nft_markers/machine_1/" smooth="true" smoothCount="10" smoothTolerance=".01" smoothThreshold="5" id="machine1-marker" data-mac="D0:EF:76:45:ED:DF">
        <a-entity visible="false" position="0 0 0"></a-entity>
    </a-nft>
    
    <a-nft type="nft" url="https://cors-anywhere.herokuapp.com/https://raw.githubusercontent.com/alssnfb/nftmarkertest/main/nft_markers/machine_2/" smooth="true" smoothCount="10" smoothTolerance=".01" smoothThreshold="5" id="machine2-marker" data-mac="D0:EF:76:44:C4:EF">
        <a-entity visible="false" position="0 0 0"></a-entity>
    </a-nft>
    
    <a-nft type="nft" url="https://cors-anywhere.herokuapp.com/https://raw.githubusercontent.com/alssnfb/nftmarkertest/main/nft_markers/machine_3/" smooth="true" smoothCount="10" smoothTolerance=".01" smoothThreshold="5" id="machine3-marker" data-mac="D0:EF:76:45:38:2B">
        <a-entity visible="false" position="0 0 0"></a-entity>
    </a-nft>
    
    <a-nft type="nft" url="https://cors-anywhere.herokuapp.com/https://raw.githubusercontent.com/alssnfb/nftmarkertest/main/nft_markers/machine_4/" smooth="true" smoothCount="10" smoothTolerance=".01" smoothThreshold="5" id="machine4-marker" data-mac="D0:EF:76:45:53:EB">
        <a-entity visible="false" position="0 0 0"></a-entity>
    </a-nft>

        <a-box
            id="grandbox"
            position="0 1.25 -3"
            rotation="0 0 0"
            color="#00a335"
            scale="2 1 0.5"
            frustumCulled="false"
        >
        </a-box>
 
        <a-text
            id="hours"
            value=""
            color="white"
            width="1.3"
            scale="1.2 0.7 1.2"
            position="-0.7 1.65 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
 
        <a-text
            id="perf"
            color="white"
            width="1.3"
            scale="1 0.5 1"
            position="0.5 1.65 -2.4"
            frustumCulled="false"
        >
        </a-text>
        <a-text
            id="itemtool"
            color="white"
            width="1.3"
            scale="1 0.5 1"
            position="0.5 1.60 -2.4"
            frustumCulled="false"
        >
        </a-text>
 
        <a-text
            id="rescode"
            color="white"
            width="1.3"
            scale="3 1.8 3"
            position="0 1.57 -2.4"
            align="center"
            frustumCulled="false"        
        >
        </a-text>
 
        <a-text
        id="status"
        color="white"
        width="1.3"
        scale="2.3 1 2.3"
        position="0 1.43 -2"
        align="center"
        frustumCulled="false"
    >
    </a-text>
   
        <!-- Barra de Produção -->
        <a-entity position="0 1.43 -2.2" frustumCulled="false">
            <a-box
                position="0 0 0"  
                scale="0 0.1 0.1"  
                color="darkgreen"
                id="production-bar-fill"
            ></a-box>
        </a-entity>
 
        <a-text
            id="statusNum"
            value="%"
            color="white"
            width="1.3"
            scale="1.5 0.9 1.5"
            position="0 1.3 -2.4"
            align="center"
            frustumCulled="false"
            random-progress
        >
        </a-text>  
 
        <a-entity line="start: -0.8 1.25 -2.4; end: 0.8 1.25 -2.4; color: white"></a-entity>
 
        <a-text
            value="TC"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.75 1.2 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
        <a-text
            id="cycletime"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.75 1.15 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>  
 
        <a-text
            value="OP"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.45 1.2 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
        <a-text
            id="operationcode"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.45 1.15 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>  
 
        <a-text
            value="QTD"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.15 1.2 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
        <a-text
            id="quantity"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.15 1.15 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>  
 
        <a-text
            value="QTD PROD"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="0.14 1.2 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
        <a-text
            id="quantityprod"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="0.14 1.15 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>  
 
        <a-text
            value="REF"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="0.40 1.2 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
        <a-text
            id="scrapquantity"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="0.40 1.15 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
 
        <a-text
            value="QTD BOA"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="0.65 1.2 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
        <a-text
            id="goodquantity"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="0.65 1.15 -2.4"
            align="center"
            frustumCulled="false"
        >
        </a-text>
 
        <a-entity line="start: -0.8 1.1 -2.4; end: 0.8 1.1 -2.4; color: white" frustumCulled="false"></a-entity>
 
        <a-text
            id="item"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.8 1.05 -2.4"
            align="left"
            frustumCulled="false"
        >
        </a-text>
 
        <a-text
            id="nextop"
            color="white"
            width="1.3"
            scale="1.2 0.8 1.2"
            position="-0.8 0.93 -2.4"
            align="left"
            frustumCulled="false"
        >
        </a-text>
 
    <!-- GAUGES -->
     <!-- position vertical dos gauges mudada de 0.2 para 0.5 -->
     <a-entity id="gauges-group" visible="false" frustumCulled="false">
        <a-entity id="gauge-OEE" position="-1 0.5 -2.4" scale="0.35 0.35 0.35">
            <a-ring id="ring-OEE" color="blue" radius-inner="0.35" radius-outer="0.45" theta-start="0" theta-length="0"></a-ring>
            <a-text id="text-OEE" value="OEE: 0%" position="0 0.6 0" align="center" color="white"></a-text>
        </a-entity>
        <a-entity id="gauge-Disponibilidade" position="0 0.5 -2.4" scale="0.35 0.35 0.35">
            <a-ring id="ring-Disponibilidade" color="green" radius-inner="0.35" radius-outer="0.45" theta-start="0" theta-length="0"></a-ring>
            <a-text id="text-Disponibilidade" value="Disponibilidade: 0%" position="0 0.6 0" align="center" color="white"></a-text>
        </a-entity>
        <a-entity id="gauge-Performance" position="1 0.5 -2.4" scale="0.35 0.35 0.35">
            <a-ring id="ring-Performance" color="red" radius-inner="0.35" radius-outer="0.45" theta-start="0" theta-length="0"></a-ring>
            <a-text id="text-Performance" value="Performance: 0%" position="0 0.6 0" align="center" color="white"></a-text>
        </a-entity>
        <a-entity id="gauge-Qualidade" position="2 0.5 -2.4" scale="0.35 0.35 0.35">
            <a-ring id="ring-Qualidade" color="yellow" radius-inner="0.35" radius-outer="0.45" theta-start="0" theta-length="0"></a-ring>
            <a-text id="text-Qualidade" value="Qualidade: 0%" position="0 0.6 0" align="center" color="white"></a-text>
        </a-entity>
    </a-entity>
    <script>
        // Detect when NFT markers are found
        document.querySelector('#machine1-marker').addEventListener('markerFound', async function () {
            console.log('Machine 1 NFT marker detected!');
            await fetchMachineData(); // Call your function to fetch data
        });

        document.querySelector('#machine1-marker').addEventListener('markerLost', function () {
            console.log('Machine 1 marker lost.');
        });

        document.querySelector('#machine2-marker').addEventListener('markerFound', async function () {
            console.log('Machine 2 NFT marker detected!');
            await fetchMachineData();
        });

        document.querySelector('#machine2-marker').addEventListener('markerLost', function () {
            console.log('Machine 2 marker lost.');
        });
    </script>
    
</a-scene>
 
    <script>
    navigator.mediaDevices
            .getUserMedia({
                video: {
                    width: { ideal: 1280 }, // Ideal width
                    height: { ideal: 960 }, // Ideal height
                    facingMode: "environment", // Use rear camera if available
                },
            })
            .then((stream) => {
                const video = document.createElement("video");
                video.srcObject = stream;
                video.play();
                initAR();
            })
            .catch((err) => alert("Camera permission denied:", err));
    </script>
</body>
</html>
 